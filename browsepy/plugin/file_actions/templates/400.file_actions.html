{% extends "base.html" %}

{% set buttons %}
  {% if file %}
    <a
      class="long button text"
      href="{{ url_for('browsepy.browse', path=file.urlpath) }}"
      title="Go back">Accept</a>
  {% else %}
    <a
      class="long button text"
      href="{{ url_for('browsepy.index') }}"
      title="Go home">Accept</a>
  {% endif %}
{% endset %}

{% set messages %}
  {% for issue in issues %}
     <p><span class="issue-name">{{ issue.item.name }}</span>: {{ issue.message }}</p>
  {% endfor %}
{% endset %}

{% if error and error.code %}
  {% if error.code.startswith('directory-') %}
    {% set workaround %}
      <p>Please try again with other directory name or contact server administrator.</p>
    {% endset %}
    {% if error.code == 'directory-invalid-name' %}
      {% set description %}
        <h2>Directory name is not valid</h2>
        <p>Given directory name is not valid: incompatible name encoding or reserved name on filesystem.</p>
        {{ workaround }}
      {%- endset %}
    {% elif error.code == 'directory-mkdir-error' %}
      {% set description %}
        <h2>Directory creation failed</h2>
        <p>{{ error.message }}.</p>
        {{ workaround }}
      {%- endset %}
    {% endif %}
  {% elif error.code.startswith('clipboard-') %}
    {% set workaround %}
      <p>Please try again, if this problem persists contact server administrator.</p>
    {% endset %}
    {% if error.code == 'clipboard-invalid-items' %}
      {% set description -%}
        {% if issues.length == 1 -%}
          <h2>A clipboard item is not valid</h2>
        {%- else -%}
          <h2>Some clipboard items are not valid</h2>
        {%- endif %}
        {{ messages }}
        {{ workaround }}
      {%- endset %}
    {% elif error.code == 'clipboard-invalid-size' %}
      {% set description -%}
        <h2>Session size limit exceeded, clipboard lost.</h2>
        <p>Clipboard became too big to be stored in your browser cookies.</p>
        <p>Please try again with fewer items and avoid other operations in the process.</p>
      {%- endset %}
    {% else %}
      {% set description %}
        <h2>Clipboard state is corrupted</h2>
        <p>Saved clipboard state is no longer valid.</p>
        {{ workaround }}
      {% endset %}
    {% endif %}
  {% endif %}
{% else %}
  {% set description %}
    <h2>Unexpected error</h2>
    <p>Operation failed due an unexpected error.</p>
    <p>Please contact server administrator.</p>
  {% endset %}
{% endif %}

{% block title %}400 Bad Request{% endblock %}

{% block header %}
  <h1>Bad Request</h1>
{% endblock %}

{% block content %}
  {{ description }}
  {{ buttons }}
{% endblock %}
